"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=_interopRequireWildcard(require("react"));require("intersection-observer");function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!==_typeof(a)&&"function"!=typeof a)return{default:a};var c=_getRequireWildcardCache(b);if(c&&c.has(a))return c.get(a);var d={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!=f&&Object.prototype.hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d["default"]=a,c&&c.set(a,d),d}function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,_toPropertyKey(c.key),c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _createSuper(a){var b=_isNativeReflectConstruct();return function(){var c,d=_getPrototypeOf(a);if(b){var e=_getPrototypeOf(this).constructor;c=Reflect.construct(d,arguments,e)}else c=d.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _possibleConstructorReturn(a,b){if(b&&("object"===_typeof(b)||"function"==typeof b))return b;if(void 0!==b)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _defineProperty(a,b,c){return b=_toPropertyKey(b),b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"===_typeof(b)?b:b+""}function _toPrimitive(a,b){if("object"!==_typeof(a)||null===a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var d=c.call(a,b||"default");if("object"!==_typeof(d))return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}var ReactUltimateCarousel=function(a){function b(a){var d;return _classCallCheck(this,b),d=c.call(this,a),_defineProperty(_assertThisInitialized(d),"handleIntersection",function(a,b){a.forEach(function(a){a.isIntersecting&&d.setState({visibleIndex:b})})}),_defineProperty(_assertThisInitialized(d),"handleMouseDown",function(a){var b=a.clientY,c=a.clientX,e=d.carouselRef.current,f=e.scrollTop,g=e.scrollLeft;d.setState({isDragging:!0,dragStartPositionY:b,dragStartPositionX:c,dragStartScrollTop:f,dragStartScrollLeft:g}),document.addEventListener("mousemove",d.handleMouseMove),document.addEventListener("mouseup",d.handleMouseUp)}),_defineProperty(_assertThisInitialized(d),"handleMouseMove",function(a){if(d.state.isDragging){var b=a.clientY,c=a.clientX,e=d.state,f=e.dragStartPositionY,g=e.dragStartPositionX,h=e.dragStartScrollTop,i=e.dragStartScrollLeft;d.isVertical?d.carouselRef.current.scrollTop=h-(b-f):d.carouselRef.current.scrollLeft=i-(c-g)}}),_defineProperty(_assertThisInitialized(d),"handleMouseUp",function(){d.setState({isDragging:!1}),document.removeEventListener("mousemove",d.handleMouseMove),document.removeEventListener("mouseup",d.handleMouseUp)}),_defineProperty(_assertThisInitialized(d),"observeIntersection",function(a,b){var c=new IntersectionObserver(function(a){return d.handleIntersection(a,b)},{root:null,rootMargin:"0px",threshold:d.props.threshold||.5});c.observe(a),d.observers.push(c)}),_defineProperty(_assertThisInitialized(d),"navigateSlide",function(a){var b,c=d.state.visibleIndex,e=_react["default"].Children.count(d.props.children),f=d.props.startingIndex||0;"number"==typeof a?b=(a-f+e)%e:"next"===a?b=(c+1)%e:"previous"==a&&(b=(c-1+e)%e),b=(b+f)%e,d.carouselRef.current.scrollTo({top:0,left:b*d.carouselRef.current.offsetWidth,behavior:"number"==typeof a?"instant":"smooth"}),d.setState({visibleIndex:b})}),d.state={visibleIndex:a.startingIndex||0,isDragging:!1,dragStartPositionY:0,dragStartPositionX:0,dragStartScrollTop:0,dragStartScrollLeft:0},d.carouselRef=_react["default"].createRef(),d.childrenRefs=[],d.observers=[],d.isVertical="vertical"===d.props.axis,d}_inherits(b,a);var c=_createSuper(b);return _createClass(b,[{key:"componentDidMount",value:function(){this.childrenRefs.forEach(this.observeIntersection);var a=this.props.startingIndex;a&&0<=a&&a<this.childrenRefs.length&&(this.carouselRef.current.scrollTo({top:0,left:a*this.carouselRef.current.offsetWidth,behavior:"auto"}),this.setState({visibleIndex:a}))}},{key:"componentWillUnmount",value:function(){this.observers.forEach(function(a){return a.disconnect()})}},{key:"componentDidUpdate",value:function(a,b){var c=this.state.visibleIndex;c!==b.visibleIndex&&this.props.onChange&&this.props.onChange(c)}},{key:"render",value:function(){var a=this,b=this.props.children,c=this.state,d=c.visibleIndex,e=c.isDragging,f={scrollSnapType:e?"none":"".concat(this.isVertical?"y":"x"," mandatory"),whiteSpace:this.isVertical?"normal":"nowrap"};return _react["default"].createElement(_react["default"].Fragment,null,_react["default"].createElement("div",{style:f,className:"carousel",ref:this.carouselRef,onMouseDown:this.handleMouseDown},_react["default"].Children.map(b,function(b,c){return _react["default"].cloneElement(b,{key:c,isActive:c===d,innerRef:function(b){return a.childrenRefs[c]=b}})})),this.props.renderControls&&this.props.renderControls({navigateSlide:this.navigateSlide,visibleIndex:this.state.visibleIndex}))}}]),b}(_react.Component),_default=ReactUltimateCarousel;exports["default"]=_default;